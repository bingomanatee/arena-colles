module.exports = function(data, callback) {
    var self = this;

    function _post_insert(err, result) {
        if (err) {
            console.log(__filename, ': put: error ', err);
        }
        callback(err, result);
    }

    if (this.config.coll) {
        if (data._id) {
            data._id = self._as_oid(data._id);
            console.log(__filename, 'Checking id ', data._id);
            self.get(data._id, function(err, result) {
                console.log('... found ', result);
                
                if (result) {
                    console.log('updating ', data);
                    self.config.coll.save(data, callback);
                } else {
                    console.log('inserting', data);
                    self.config.coll.insert(data, callback);
                }
            });
        } else {
            self.config.coll.insert(data, callback);
        }
    } else {
        callback(new Error('No Collection'));
    }
}