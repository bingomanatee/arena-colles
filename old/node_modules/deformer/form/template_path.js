var ejs = require('ejs');
var fs = require('fs');
var properties_template = fs.readFileSync(__dirname + '/../templates/properties.html').toString();

module.exports = function(self, field) {
    var template_path = field.type + '.html';

    if (self.configs.templates.hasOwnProperty(field.type)) {
        template_path = self.configs.templates[field.type];
    }

    if (field.hasOwnProperty('template')) {
        template_path = field.template;
    }

    if (field.hasOwnProperty('properties')) {
        field.property = ejs.render(properties_template, {
            locals: {
                properties: field.properties
            }
        });
    }

    if (/^\//.test(template_path)) {} else {
        template_path = __dirname + '/../templates/' + template_path;
    }

    if (!/\.html/.test(template_path)) {
        template_path += '.html';
    }

    return template_path;
}