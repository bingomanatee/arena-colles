var path_module = require('path');
var fs = require('fs');

/**
 * Returns a list of files that match the .js pattern
 * of JavaScript files.
 */

var jsext = /\.js$/;

function _is_js(f) {
    return jsext.test(f);
}

function _no_ext(f) {
    return f.replace(jsext, '');
}

function _js_files(files, path, no_ext) {
    var out = files.filter(_is_js);
    if (no_ext) {
        out = _.map(out, _no_ext);
    }
    out = _.map(out, function(p){return path + '/' + p;});
    
    return out;
}

module.exports = function(path, no_ext) {
    path = path.replace(/\/$/, '');
    if (!path_module.existsSync(path)) {
        console.log(__filename, ': bad path ', path);
        throw new Error(__filename + ': ' + path + ' does not exist: ');
    }

    var files = fs.readdirSync(path);
    files = _js_files(files, path, no_ext);
    return files;
}