
var Stat = require('stat');

module.exports = function(samples, buckets) {
        var pc = this.get_point_count();

        var increment = Math.max(1, parseInt( pc/ samples));
        
        var samp = [];
        var cols = this.get_cols();
        
        for (var i = 0; i < pc; i += increment) {
            var r = Math.floor(i / cols);
            var c = i % cols;
            samp.push(this.data[r][c]);
        }

        var stat = new Stat(samp);
        this.std_dev = stat.std_dev();
        this.avg = stat.avg();

        console.log('stat: avg = ', this.avg, '; stdev = ', this.std_dev, ': samples - ', samp.length, '(target: ', samples, ')');
        
        var bins = this._measure_bins(samp, buckets);
        this._fill_bins(samp, bins);
        
        return bins;
    }