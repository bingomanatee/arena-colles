var Canvas = require('canvas');

module.exports = function() {
    var self = this;
    console.log(__filename, ': l = ', this.data.length);
    if (this.end_row) {
        console.log(__filename, ': writing canvas for ', this.cols, ', ', this.start_row, '... ', this.end_row, ' (', this.rows(), ') rows ');
    } else {
        console.log(__filename, ': writing canvas for c ', this.get_cols(), ', r ', this.get_rows());
    }

 //   console.log('expected heights: ', this.get_point_count());
  //  console.log('height count: ', this.get_data_count());
    // if (this.data.length < eh) throw new Error(__filename + 'as_canvas: not enough image data');
    var canvas = new Canvas(this.get_cols(), this.get_rows());
    console.log('NEW CANVAS SIZE', canvas.width, canvas.height);
    var ctx = canvas.getContext('2d');

    for (var r = 0; r < this.get_rows(); r += this.image_tile_rows) {
        for (var c = 0; c < this.get_cols(); c += this.image_tile_cols) {

            this.render_image_tile(ctx, r, c);
        }
    }

    console.log('done drawing image data');
    return canvas;
}