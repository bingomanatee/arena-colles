var fs = require('fs');

module.exports = function (out_path, callback) {
    var write_stream = fs.createWriteStream(out_path);
    for (var r = 0; r < this.rows; ++r) {
        var b = new Buffer(this.cols * 2);
        this.data[r].forEach(function (n, i) {
            b.writeInt16BE(n, i * 2);
        });
        write_stream.write(b);
    }
    write_stream.end();
    write_stream.destroySoon();
    write_stream.on('close', callback);
}